@vulnerability @odc-5131
Feature: Image Vulnerability in Project
              As a user, I would like to see Image Vulnerability in Project


        Background:
            Given user has installed Quay Container Security Operator
              And user has created or selected namespace "aut-image-vulnerability"
              And user is at developer perspective


        @regression
        Scenario Outline: Vulnerability tab in developer console: PV-01-TC01
            Given user created deployment resource using YAML editor from "<deployment_yaml>"
              And user is at project tab
             When user clicks on the vulnerability tab
             Then user can see Image Manifest vulnerabilities
              And user can see filter with "Name" option selected
              And user can see 'Image name', 'Highest severity', 'Affected Pods', 'Fixable', 'Total', and 'Manifest'


        Examples:
                  | deployment_yaml                                       |
                  | testData/vulnerability/create-quarkus-deployment.yaml |


        @regression @manual
        Scenario: Visit quay page from status in project overview: PV-01-TC02
            Given user is at project tab
             When user clicks on the Image Vulnerabilities in Status section
              And user clicks on the fixable link in Image Vulnerability breakdown pop over
             Then user can see the image open in quay.io


        @regression
        Scenario: Filter in vulnerability tab: PV-01-TC03
            Given user is at project tab
             When user clicks on the Image Vulnerabilities in Status section
              And user clicks on the View all link on Image Vulnerability breakdown pop overview
              And user clicks on dropdown associated with filter
              And user clicks on label option
             Then user can see filter with "Label" option selected


        @regression
        Scenario: Image manifests vulnerability details page: PV-01-TC04
            Given user is at project tab
             When user clicks on the Image Vulnerabilities in Status section
              And user clicks on the image name in Image Vulnerability breakdown pop over
              And user clicks on "Base image" type of vulnerability
             Then user can see image manifest vulnerability Details, YAML and Affected Pods tabs on ImageManifestsVuln Details page
              And user can see "Base image" vulnerabilities tab selected


        @regression
        Scenario: Filters of vulnerability section in Image manifests vulnerability details page: PV-01-TC05
            Given user is at Image manifests vulnerability details page of 'redhat-appstudio-qe/quarkus'
             When user clicks on Filter dropdown menu in vulnerabilities section
              And user clicks on "App dependency" Type filter
             Then user can see "App dependency" filter selected
              And user can see "Defcon1", "Critical", "High", "Medium", "Low", "Negligible" and "Unknown" in Severity filter
